@inherits FluxorComponent
@inject NavigationManager NavigationManager
@inject AuthFacade AuthFacade
@inject IState<AuthState> AuthState

<MudTooltip Text="@(AuthState.Value.Session?.User?.Email)" 
            Placement="Placement.Start">
    <MudMenu Icon="@Icons.Material.Filled.PersonPin"
             Color="Color.Tertiary"
             Dense AnchorOrigin="Origin.TopRight">
        <ActivatorContent>
            <MudIconButton Icon="@Icons.Material.Filled.PersonPin"
                           Title="@(AuthState.Value.Session?.User?.Email)" 
                           aria-label="@(AuthState.Value.Session?.User?.Email)"
                           Color="Color.Inherit"/>
        </ActivatorContent>
        <ChildContent>
            <AuthorizeView>
                <Authorized>
                    <MudMenuItem Icon="@Icons.Custom.FileFormats.FileDocument">
                        Profile
                    </MudMenuItem>
                    <MudMenuItem Icon="@Icons.Material.Filled.Logout"
                                 OnClick="Logout">
                        Logout
                    </MudMenuItem>
                </Authorized>
                <NotAuthorized>
                    <MudMenuItem Icon="@Icons.Material.Filled.Person"
                                 OnClick="GoToLogin">
                        Sign in
                    </MudMenuItem>
                    <MudMenuItem Icon="@Icons.Material.Filled.PersonAdd"
                                 OnClick="GoToRegister">
                        Sign up
                    </MudMenuItem>
                </NotAuthorized>
            </AuthorizeView>
        </ChildContent>
    </MudMenu>
</MudTooltip>

@code {

    private void Logout()
        => AuthFacade.Logout();

    private void GoToLogin()
        => NavigationManager.NavigateTo("/authentication/login");

    private void GoToRegister()
        => NavigationManager.NavigateTo("/authentication/register");

}